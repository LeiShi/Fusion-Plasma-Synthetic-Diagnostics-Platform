<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Beam Emission Spectroscopy (BES) Directory &mdash; BES 0.8 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="BES 0.8 documentation" href="index.html" />
    <link rel="up" title="Diagnostics Directory" href="FPSDP.Diagnostics.html" />
    <link rel="next" title="Beam Simulation" href="FPSDP.Diagnostics.Beam.html" />
    <link rel="prev" title="Diagnostics Directory" href="FPSDP.Diagnostics.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="FPSDP.Diagnostics.Beam.html" title="Beam Simulation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="FPSDP.Diagnostics.html" title="Diagnostics Directory"
             accesskey="P">previous</a> |</li>
        <li><a href="FPSDP.html">BES 0.8 documentation</a> &raquo;</li>
          <li><a href="FPSDP.Diagnostics.html" accesskey="U">Diagnostics Directory</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="beam-emission-spectroscopy-bes-directory">
<h1>Beam Emission Spectroscopy (BES) Directory<a class="headerlink" href="#beam-emission-spectroscopy-bes-directory" title="Permalink to this headline">¶</a></h1>
<p>In order to compare the exact density fluctuation and the BES diagnostic, two classes have been created.
A first one that implement the diagnostic (<a class="reference internal" href="#FPSDP.Diagnostics.BES.bes.BES" title="FPSDP.Diagnostics.BES.bes.BES"><tt class="xref py py-class docutils literal"><span class="pre">BES</span></tt></a>) and a second one that copy the
structure of the diagnostic and just take density value at the focus points (<a class="reference internal" href="#FPSDP.Diagnostics.BES.bes.BES_ideal" title="FPSDP.Diagnostics.BES.bes.BES_ideal"><tt class="xref py py-class docutils literal"><span class="pre">BES_ideal</span></tt></a>).</p>
<div class="section" id="module-FPSDP.Diagnostics.BES.bes">
<span id="function-defined-in-the-module"></span><h2>Function Defined in the Module<a class="headerlink" href="#module-FPSDP.Diagnostics.BES.bes" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="FPSDP.Diagnostics.BES.bes.heuman">
<tt class="descclassname">FPSDP.Diagnostics.BES.bes.</tt><tt class="descname">heuman</tt><big>(</big><em>phi</em>, <em>m</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#heuman"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.heuman" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Heuman&#8217;s lambda function</p>
<p><span class="math">\(\Lambda_0 (\xi,k) = \frac{2}{\pi}\left[E(k)F(\xi,k') + K(k)E(\xi,k')- K(k)F(\xi,k')\right]\)</span>
where <span class="math">\(k' = \sqrt{(1-k^2)}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi</strong> (<em>np.array[N]</em>) &#8211; The amplitude of the elliptic integrals</li>
<li><strong>m</strong> (<em>np.array[N]</em>) &#8211; The parameter of the elliptic integrals</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Evaluation of the Heuman&#8217;s lambda function</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="FPSDP.Diagnostics.BES.bes.solid_angle_disk">
<tt class="descclassname">FPSDP.Diagnostics.BES.bes.</tt><tt class="descname">solid_angle_disk</tt><big>(</big><em>pos</em>, <em>r</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#solid_angle_disk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.solid_angle_disk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the solid angle of a disk on/off-axis from the pos
the center of the circle should be in (0,0,0)</p>
<div class="math">
\[\begin{split}\Omega = \left\{\begin{array}{lr}
2\pi-\frac{2L}{R_\text{max}}K(k)-\pi\Lambda_0(\xi,k) &amp; r_0 &lt; r_m \\
\phantom{2}\pi-\frac{2L}{R_\text{max}}K(k) &amp; r_0 = r_m \\
\phantom{2\pi}-\frac{2L}{R_\text{max}}K(k)+\pi\Lambda_0(\xi,k) &amp; r_0 &gt; r_m \\
\end{array}\right.\end{split}\]</div>
<p>Read the paper of <a class="reference external" href="http://scitation.aip.org/content/aip/journal/rsi/30/4/10.1063/1.1716590">Paxton</a> &#8220;Solid Angle Calculation for a 
Circular Disk&#8221; in 1959 for the exact computation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position from which computing the solid angle</li>
<li><strong>r</strong> (<em>float</em>) &#8211; Radius of the disk (the disk is centered in (0,0,0) and the perpendicular is along the z-axis)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Solid angle for each positions</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="beam-emission-spectroscopy">
<h2>Beam Emission Spectroscopy<a class="headerlink" href="#beam-emission-spectroscopy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="FPSDP.Diagnostics.BES.bes.BES">
<em class="property">class </em><tt class="descclassname">FPSDP.Diagnostics.BES.bes.</tt><tt class="descname">BES</tt><big>(</big><em>input_file</em>, <em>parallel=False</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES" title="Permalink to this definition">¶</a></dt>
<dd><p>Class computing the image of all the fibers.</p>
<p>Load the parameter from a config file and create everything from it.
The function <a class="reference internal" href="#FPSDP.Diagnostics.BES.bes.BES.get_bes" title="FPSDP.Diagnostics.BES.bes.BES.get_bes"><tt class="xref py py-func docutils literal"><span class="pre">get_bes()</span></tt></a> is used for computing the intensity received by
each fiber (number of photons per second).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_file</strong> (<em>str</em>) &#8211; Name of the config file</li>
<li><strong>parallel</strong> (<em>bool</em>) &#8211; Choice between the serial code or the parallel one</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>self.cfg_fil</strong> (<em>str</em>) &#8211; Name of the config file</li>
<li><strong>self.para</strong> (<em>bool</em>) &#8211; Choice between the serial code and the parallel one</li>
<li><strong>self.pos_lens</strong> (<em>np.array[3]</em>) &#8211; Position of the lens (in the cartesian system)</li>
<li><strong>self.rad_ring</strong> (<em>np.array[Nfib]</em>) &#8211; Radius of the focus point for each fiber</li>
<li><strong>self.rad_lens</strong> (<em>float</em>) &#8211; Radius of the lens</li>
<li><strong>self.inter</strong> (<em>float</em>) &#8211; Cutoff distance from the focus point (in unit of the beam width)</li>
<li><strong>self.Nint</strong> (<em>int</em>) &#8211; Number of point for splitting the integral over the optical direction</li>
<li><strong>self.Nsol</strong> (<em>int</em>) &#8211; Number of interval for the evaluation of the solid angle in the mixed case</li>
<li><strong>self.pos_foc</strong> (<em>np.array[Nfib,3]</em>) &#8211; Position of the focus points (in the cartesian system)</li>
<li><strong>self.op_direc</strong> (<em>np.array[Nfib,3]</em>) &#8211; Direction of the optical line (for each fiber)</li>
<li><strong>self.dist</strong> (<em>np.array[Nfib]</em>) &#8211; Distance between the focus point and the lens</li>
<li><strong>self.perp1</strong> (<em>np.array[Nfib,3]</em>) &#8211; Second basis vector for each fiber coordinates (first is the optical line)</li>
<li><strong>self.perp2</strong> (<em>np.array[Nfib,3]</em>) &#8211; Third basis vector</li>
<li><strong>self.type_int</strong> (<em>str</em>) &#8211; choice between the full computation of the intensity or only over the central line (&#8216;1D&#8217; or &#8216;2D&#8217;)</li>
<li><strong>self.t_max</strong> (<em>float</em>) &#8211; Cutoff time for the lifetime effect (in unit of the lifetime).    If set to 0, the lifetime will not be taken in account</li>
<li><strong>self.lifetime</strong> (<em>bool</em>) &#8211; Choice between using the lifetime effect or not</li>
<li><strong>self.tau_max</strong> (<em>float</em>) &#8211; Upper limit for the lifetime of the excited particles.    It does not need to be exact, it is only for computing the limits of the mesh.</li>
<li><strong>self.N_field</strong> (<em>int</em>) &#8211; Number of interval for the field line interpolation</li>
<li><strong>self.data_path</strong> (<em>str</em>) &#8211; Path to the data</li>
<li><strong>self.beam</strong> &#8211; (<a class="reference internal" href="FPSDP.Diagnostics.Beam.html#FPSDP.Diagnostics.Beam.beam.Beam1D" title="FPSDP.Diagnostics.Beam.beam.Beam1D"><tt class="xref py py-class docutils literal"><span class="pre">Beam1D</span></tt></a>) Beam used for the diagnostic</li>
<li><strong>self.time</strong> (<em>np.array[Ntime]</em>) &#8211; Time steps used for the simulation</li>
<li><strong>self.filter</strong> (<em>tck_interp</em>) &#8211; Interpolant of the filter</li>
<li><strong>self.wl0</strong> (<em>float</em>) &#8211; Wavelength of the de-excitation photons</li>
<li><strong>self.Xmax</strong> (<em>float</em>) &#8211; Upper limit of the X coordinate</li>
<li><strong>self.Xmin</strong> (<em>float</em>) &#8211; Lower limit of the X coordinate</li>
<li><strong>self.Ymax</strong> (<em>float</em>) &#8211; Upper limit of the Y coordinate</li>
<li><strong>self.Ymin</strong> (<em>float</em>) &#8211; Lower limit of the Y coordinate</li>
<li><strong>self.Zmax</strong> (<em>float</em>) &#8211; Upper limit of the Z coordinate</li>
<li><strong>self.Zmin</strong> (<em>float</em>) &#8211; Lower limit of the Z coordinate</li>
<li><strong>self.limits</strong> (<em>np.array[3,2]</em>) &#8211; Limits of the mesh (first index for X,Y,Z and second for max,min)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.check_in">
<tt class="descname">check_in</tt><big>(</big><em>pos</em>, <em>fib</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.check_in"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.check_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the position (optical coordinate) is inside the first cone (blue area)
(if the focus ring matter or not).
The shape of the sampling area is asume to be linear along the z-axis (optic direction).</p>
<div class="figure">
<p><img src="_images/tikz-a9618f77893940248d8923402e582d711e241386.png" alt="\draw[fill=blue] (-1,0) -- (3,2) -- (3,-2) -- cycle;
\draw[ultra thick] (3,2) -- (3,-2);           
\draw[thick] (0,0.5) -- (0,-0.5);
\draw[dashed] (-3,-2) -- (1,0) -- (-3,2);
\node at (3.5, 0) {Lens};
\node at (0,0.9) {Ring};" /></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position in the optical system</li>
<li><strong>fib</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if inside the first cone</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N] of bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.compute_limits">
<tt class="descname">compute_limits</tt><big>(</big><em>eps=0.05</em>, <em>dxmin=0.1</em>, <em>dymin=0.1</em>, <em>dzmin=0.1</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.compute_limits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.compute_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the limits of the mesh that should be loaded</p>
<p>The only limitations comes from the sampling volume and the lifetime of the excited state.
In the figure below, blue is for the beam and the lifetime effect, red for the ring and the cutoff values,
straight black lines are for the sampling volume, and, the dashed one are the box.</p>
<div class="figure">
<p><img src="_images/tikz-780c2c8196ce13513b30a547f2466d39f2da7b38.png" alt="% beam
\draw[blue] (-5,0.5) -- (7,0.5);
\draw[blue] (-5,-0.5) -- (7,-0.5);
\node[blue] at (-4.5,0) {Beam};
\draw[-&gt;,thick,blue] (-3.5,0) -- (-2.5,0);
% Sampling volume + ring
\draw (3,-3.7) -- (2.8,-0.1);
\draw (3.4,0.1) -- (6,-2.8);
\draw (0.4,2.5) -- (2.8,-0.1);
\draw (3.4,0.1) -- (3,2.9);
\draw[red] (2.8,-0.1) -- (3.4,0.1);
%cutoff
\draw[red] (2.825,-1) -- (4,-0.56);
\draw[red] (2.15,0.6) -- (3.25,1);
%lifetime effect
\draw[blue,-&gt;] (2.15,0.6) -- (1.65,0.6);
\draw[blue,-&gt;] (2.825,-1) -- (2.325,-1);
\draw[blue,-&gt;] (4,-0.56) -- (3.5,-0.56);
\draw[blue,-&gt;] (3.25,1) -- (2.75,1);
%box
\draw[dashed] (1.5, 1.1) -- (1.5,-1.1) -- (4.1,-1.1) -- (4.1,1.1) -- cycle;" /></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>eps</strong> (<em>float</em>) &#8211; Used for increasing the size of the box (relative size)</li>
<li><strong>dxmin</strong> (<em>float</em>) &#8211; Smallest size accepted for the box in X</li>
<li><strong>dymin</strong> (<em>float</em>) &#8211; Smallest size accepted for the box in Y</li>
<li><strong>dzmin</strong> (<em>float</em>) &#8211; Smallest size accepted for the box in Z</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.get_bes">
<tt class="descname">get_bes</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.get_bes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.get_bes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the image of the density turbulence.
This function should be the only one used outside the class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Intensity collected by each fiber (number of photons)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">np.array[Ntime, Nfib]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.get_emis_from">
<tt class="descname">get_emis_from</tt><big>(</big><em>pos</em>, <em>t_</em>, <em>fiber_nber</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.get_emis_from"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.get_emis_from" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Compute the total emission received from pos (takes in account the</dt>
<dd>solid angle and the filter).</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body"><p class="first">Improvement possible: keep in memory the solid angle for different time</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position in the optical system</li>
<li><strong>t</strong> (<em>int</em>) &#8211; Time step to compute</li>
<li><strong>fiber_nber</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Intensity collected from each point</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.get_solid_angle">
<tt class="descname">get_solid_angle</tt><big>(</big><em>pos</em>, <em>fib</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.get_solid_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.get_solid_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the solid angle</p>
<p>Three different cases can happen:
* Lens case
* Ring case
* mixed case</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body">add picture</td>
</tr>
</tbody>
</table>
<p>The two first are solved with the formula of Paxton (<a class="reference internal" href="#FPSDP.Diagnostics.BES.bes.solid_angle_disk" title="FPSDP.Diagnostics.BES.bes.solid_angle_disk"><tt class="xref py py-func docutils literal"><span class="pre">solid_angle_disk()</span></tt></a>) and
the last one is solved numerically.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position in the optical system</li>
<li><strong>fib</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Solid angle</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.get_width">
<tt class="descname">get_width</tt><big>(</big><em>pos</em>, <em>fiber_nber</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.get_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.get_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the radius of the light cone.
Assume two cones that meet at the focus disk.</p>
<div class="figure">
<p><img src="_images/tikz-c48104b94240016e63772ec2ffca2c60f7eeb6e6.png" alt="\draw (3,3) -- (-2.5,0) -- (3,-3);" /></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body"><p class="first">ADD A PICTURE IN ORDER TO EXPLAIN</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position where to compute the width in the optical system</li>
<li><strong>fiber_nber</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Radius of the optical cone</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.intensity">
<tt class="descname">intensity</tt><big>(</big><em>t_</em>, <em>fiber_nber</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.intensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the light received by a fiber at one time step.</p>
<p>Use a Gauss-Legendre quadrature formula of order 3.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body"><p class="first">ADD PICTURE</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>int</em>) &#8211; Time step to compute</li>
<li><strong>fiber_nber</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Intensity of light collected by the fiber</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.intensity_para">
<tt class="descname">intensity_para</tt><big>(</big><em>i</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.intensity_para"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.intensity_para" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#FPSDP.Diagnostics.BES.bes.BES.intensity" title="FPSDP.Diagnostics.BES.bes.BES.intensity"><tt class="xref py py-func docutils literal"><span class="pre">intensity()</span></tt></a>, but have only one argument.
The only use is for the parallelization that ask only one argument.</p>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.light_from_plane">
<tt class="descname">light_from_plane</tt><big>(</big><em>z</em>, <em>t_</em>, <em>fiber_nber</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.light_from_plane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.light_from_plane" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Compute the light from one plane using a order 10 method (see report or</dt>
<dd>Abramowitz and Stegun)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body"><p class="first">ADD PICTURE</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>np.array[N]</em>) &#8211; Distance from the fiber along the sightline</li>
<li><strong>t</strong> (<em>int</em>) &#8211; Time step to compute (is not important for the data loader, but is used as a check)</li>
<li><strong>fiber_nber</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Intensity collected by the fiber from these planes</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array[N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.load_filter">
<tt class="descname">load_filter</tt><big>(</big><em>filter_name</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.load_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.load_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the data from the filter and compute the value for the wavelengths
considered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filter_name</strong> (<em>str</em>) &#8211; Name of the file containing the filter datas</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Transmission for the wavelengths considered</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">np.array[Ncomp]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.solid_angle_mix_case">
<tt class="descname">solid_angle_mix_case</tt><big>(</big><em>pos</em>, <em>x</em>, <em>y</em>, <em>fib</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.solid_angle_mix_case"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.solid_angle_mix_case" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Compute numerically the solid angle for the mixted case</dt>
<dd>(where the lens AND the ring limit the size of the solid angle)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body"><p class="first">ADD picture</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position in the optical system</li>
<li><strong>x</strong> (<em>list[np.array[N],..]</em>) &#8211; Position of the intersection on the ring (list contains 2 elements)</li>
<li><strong>y</strong> (<em>list[np.array[N],..]</em>) &#8211; Position of the intersection on the lens (list contains 2 elements)</li>
<li><strong>fib</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.solid_angle_seg">
<tt class="descname">solid_angle_seg</tt><big>(</big><em>pos</em>, <em>x</em>, <em>r</em>, <em>islens</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.solid_angle_seg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.solid_angle_seg" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Compute the solid angle of a disk where a segment has been removed</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Todo:</th><td class="field-body"><p class="first">ADD PICTURE</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position in the optical system</li>
<li><strong>x</strong> (<em>list[np.array[N],..]</em>) &#8211; Position of the intersection on the ring (list contains 2 elements)</li>
<li><strong>r</strong> (<em>float</em>) &#8211; Radius of the disk (should be centered at (0,0,0) and the perpendicular should be along the z-axis)</li>
<li><strong>islens</strong> (<em>bool</em>) &#8211; True if the computation is for the lens (change of sign if it is the case)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES.to_cart_coord">
<tt class="descname">to_cart_coord</tt><big>(</big><em>pos</em>, <em>fiber_nber</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES.to_cart_coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES.to_cart_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the optical coordinate to the cartesian system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>np.array[N,3]</em>) &#8211; Position in the optical system</li>
<li><strong>fiber_nber</strong> (<em>int</em>) &#8211; Index of the fiber</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Position in the cartesian system</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.arrray[N,3]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="raw-electron-density-fluctuations">
<h2>Raw Electron Density Fluctuations<a class="headerlink" href="#raw-electron-density-fluctuations" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="FPSDP.Diagnostics.BES.bes.BES_ideal">
<em class="property">class </em><tt class="descclassname">FPSDP.Diagnostics.BES.bes.</tt><tt class="descname">BES_ideal</tt><big>(</big><em>input_file</em>, <em>mesh=False</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES_ideal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the output of the simulation and just 
compute the fluctuation
A lot of copy and paste from the BES class, therefore look there for
the comments</p>
<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES_ideal.compute_limits">
<tt class="descname">compute_limits</tt><big>(</big><em>eps=1</em>, <em>dxmin=0.1</em>, <em>dymin=0.1</em>, <em>dzmin=0.5</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES_ideal.compute_limits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES_ideal.compute_limits" title="Permalink to this definition">¶</a></dt>
<dd><p>find max of the focus points</p>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES_ideal.get_bes">
<tt class="descname">get_bes</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES_ideal.get_bes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES_ideal.get_bes" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the image of the turbulence in density
This function should be the only one used outside the class</p>
</dd></dl>

<dl class="method">
<dt id="FPSDP.Diagnostics.BES.bes.BES_ideal.intensity">
<tt class="descname">intensity</tt><big>(</big><em>t_</em>, <em>fiber_nber</em><big>)</big><a class="reference internal" href="_modules/FPSDP/Diagnostics/BES/bes.html#BES_ideal.intensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#FPSDP.Diagnostics.BES.bes.BES_ideal.intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the light received by the fiber #fiber_nber</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="FPSDP.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Beam Emission Spectroscopy (BES) Directory</a><ul>
<li><a class="reference internal" href="#module-FPSDP.Diagnostics.BES.bes">Function Defined in the Module</a></li>
<li><a class="reference internal" href="#beam-emission-spectroscopy">Beam Emission Spectroscopy</a></li>
<li><a class="reference internal" href="#raw-electron-density-fluctuations">Raw Electron Density Fluctuations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="FPSDP.Diagnostics.html"
                        title="previous chapter">Diagnostics Directory</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="FPSDP.Diagnostics.Beam.html"
                        title="next chapter">Beam Simulation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/FPSDP.Diagnostics.BES.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="FPSDP.Diagnostics.Beam.html" title="Beam Simulation"
             >next</a> |</li>
        <li class="right" >
          <a href="FPSDP.Diagnostics.html" title="Diagnostics Directory"
             >previous</a> |</li>
        <li><a href="FPSDP.html">BES 0.8 documentation</a> &raquo;</li>
          <li><a href="FPSDP.Diagnostics.html" >Diagnostics Directory</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Loic Hausammann.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>